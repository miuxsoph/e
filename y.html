<!DOCTYPE html>
<html>
<head>
  <style>
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: -1;
    }
  </style>
</head>
<body onclick="startAudio();">
  <canvas id="canvas"></canvas>
  <script>
    // Get the canvas element
    var canvas = document.getElementById("canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    var ctx = canvas.getContext("2d");

    // Define the initial number of polygons and their size
    var numPolygons = Math.sqrt(89);
    var polygonSize = Math.sqrt(89);

    // Define the increment values for numPolygons and polygonSize
    var numPolygonsIncrement = 5;
    var polygonSizeIncrement = 1 / 89;

    // Define the set of residues we're interested in
    var residues = [1, 7, 11, 13, 17, 19, 23, 29];

    // Define colors for each residue
    var colors = [
      "#FF0000", // Red
      "#00FF00", // Green
      "#0000FF", // Blue
      "#FFFF00", // Yellow
      "#FF00FF", // Magenta
      "#00FFFF", // Cyan
      "#FF8000", // Orange
      "#8000FF"  // Purple
    ];

    // Define the oscillator for generating sound
    var audioContext = new AudioContext();
    var oscillator = audioContext.createOscillator();
    oscillator.type = "sine";
    oscillator.frequency.value = 440; // Initial frequency

    // Function to generate random static on the canvas
    function generateStatic() {
      // Clear the canvas by setting the background to transparent
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Generate the static rectangles
      for (var i = 0; i < canvas.width; i += polygonSize) {
        for (var j = 0; j < canvas.height; j += polygonSize) {
          var x = i + polygonSize / 2;
          var y = j + polygonSize / 2;
          var index = Math.floor(Math.sqrt(x * x + y * y)) % residues.length;
          var residue = residues[index];

          // Get the color based on the residue value
          var color = colors[residue % colors.length];

          // Set the color for the rectangle
          ctx.fillStyle = color;

          // Draw the rectangle
          ctx.fillRect(i, j, polygonSize, polygonSize);
        }
      }
    }

    // Function to update the oscillator frequency based on the pattern
    function updateFrequency() {
      var pattern = Array.from(ctx.getImageData(0, 0, canvas.width, canvas.height).data);
      var sum = pattern.reduce((a, b) => a + b, 0);
      var average = sum / pattern.length;
      var frequency = average * 10; // Adjust the frequency scaling factor as needed
      oscillator.frequency.value = frequency;
    }

    // Function to start the audio
    function startAudio() {
      oscillator.start();
      generateStatic();
      setInterval(updateFrequency, 100); // Update frequency every 100 milliseconds
    }
  </script>
</body>
</html>
